<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Title</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <!-- D3 -->
    <script type="text/javascript" src="https://d3js.org/d3.v7.min.js"></script>
    <!-- Custom CSS -->
    <style>

    </style>
</head>
<body>
    <main class="container">
        <section class="vh-100 w-100">
            <!-- D3 visualization here -->
            <div id="bar-chart"></div>
        </section>
    </main>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script type="text/javascript">
        const width = 800;
        const height = 600;
        const marginBottom = 100;

        const barWidth = 50;
        const gap = 5;
        const barHeightMultiplier = .0003;

        const svg = d3.select("#bar-chart")
            .append("svg")
            .attr("viewBox", [0, 0, width, height + marginBottom]);

        function plotBarChart(dataset) {
            // rectangle bars
            svg.append("g")
                    .attr("class", "bars")
                .selectAll("rect")
                .data(dataset)
                .enter()
                .append("rect")
                    .attr("x", (d, i) => i * (barWidth + gap))
                    .attr("y", d => height - d.census_2020 * barHeightMultiplier)
                    .attr("width", barWidth)
                    .attr("height", d => d.census_2020 * barHeightMultiplier)
                    .attr("fill", "steelblue")
            // text on x-axis
            svg.append("g")
                    .attr("class", "labels")
                .selectAll("text")
                .data(dataset)
                .enter()
                .append("text")
                    .attr("x", (d, i) => i * (barWidth + gap) + barWidth/2)
                    .attr("y", height + gap)
                    .attr("dy", "1em")
                    .attr("text-anchor", "middle")
                    .attr("font-size", "0.6em")
                    .attr("fill", "black")
                    .text(d => d.county)
        };

        // load csv data
        d3.csv("./MA_population.csv", d3.autoType)
            .then(function(data) {
                console.log(data);

                plotBarChart(data);
            })

    </script>
</body>
</html>
